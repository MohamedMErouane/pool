<!DOCTYPE html>
<html>
<head>
    <title>Pool Game Debug Test</title>
    <style>
        body { margin: 0; padding: 20px; background: #1a1a1a; color: white; font-family: Arial; }
        #gameArea { text-align: center; margin: 20px auto; }
        canvas { background: #0f5d0f; border: 4px solid #8B4513; border-radius: 15px; }
        .debug-info { margin: 20px 0; padding: 20px; background: #333; border-radius: 10px; }
        .error { color: #ff6b6b; }
        .success { color: #51cf66; }
        .warning { color: #ffd93d; }
        button { padding: 10px 20px; margin: 10px; background: #4ECDC4; border: none; border-radius: 5px; color: white; cursor: pointer; }
        button:hover { background: #45B7B8; }
    </style>
</head>
<body>
    <h1>Pool Game Debug Test</h1>
    
    <div class="debug-info">
        <h3>System Status:</h3>
        <div id="debug-output"></div>
    </div>
    
    <div id="gameArea">
        <canvas id="screen" width="1500" height="825"></canvas>
    </div>
    
    <div style="text-align: center;">
        <button onclick="testInitialization()">Test Game Initialization</button>
        <button onclick="testCanvas()">Test Canvas</button>
        <button onclick="testGame()">Test Game Start</button>
    </div>

    <!-- Load LAB.js -->
    <script src="script/lib/LAB.min.js"></script>
    
    <script>
        let debugOutput = document.getElementById('debug-output');
        
        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const className = type === 'error' ? 'error' : type === 'success' ? 'success' : type === 'warning' ? 'warning' : '';
            debugOutput.innerHTML += `<div class="${className}">[${timestamp}] ${message}</div>`;
            console.log(`[${timestamp}] ${message}`);
        }
        
        function testCanvas() {
            log('=== TESTING CANVAS ===');
            
            const canvas = document.getElementById('screen');
            const gameArea = document.getElementById('gameArea');
            
            if (!canvas) {
                log('‚ùå Canvas element not found!', 'error');
                return;
            }
            
            log('‚úÖ Canvas element found');
            log(`Canvas size: ${canvas.width}x${canvas.height}`);
            
            const ctx = canvas.getContext('2d');
            if (!ctx) {
                log('‚ùå Canvas context not available!', 'error');
                return;
            }
            
            log('‚úÖ Canvas context available');
            
            // Test drawing
            ctx.fillStyle = '#ff0000';
            ctx.fillRect(10, 10, 100, 100);
            log('‚úÖ Test rectangle drawn (red square)');
        }
        
        function testInitialization() {
            log('=== TESTING INITIALIZATION ===');
            
            // Test if LAB is loaded
            if (typeof $LAB === 'undefined') {
                log('‚ùå LAB.js not loaded!', 'error');
                return;
            }
            log('‚úÖ LAB.js loaded');
            
            // Load scripts and test
            $LAB
            .script('script/geom/Vector2.js')
            .script('script/Canvas2D.js')
            .script('script/system/Keys.js')
            .script('script/system/Color.js')
            .script('script/input/ButtonState.js')
            .script('script/input/Keyboard.js')
            .script('script/input/Mouse.js')
            .script('script/game_objects/Ball.js')
            .script('script/game_objects/NumberedBall.js')
            .script('script/game_objects/Stick.js')
            .script('script/game_objects/Player.js')
            .script('script/game_objects/Score.js')
            .script('script/game_objects/Pot.js')
            .script('script/GamePolicy.js')
            .script('script/GameWorld.js')
            .script('script/AI/AIPolicy.js')
            .script('script/AI/AITrainer.js')
            .script('script/AI/Opponent.js')
            .script('script/Game.js')
            .script('script/Global.js')
            .script('script/menu/Label.js')
            .script('script/menu/Button.js')
            .script('script/menu/Menu.js')
            .script('script/menu/MainMenu.js')
            .script('script/Assets.js').wait(function () {
                log('‚úÖ All scripts loaded');
                
                // Test global objects
                if (typeof Vector2 === 'undefined') {
                    log('‚ùå Vector2 not available!', 'error');
                } else {
                    log('‚úÖ Vector2 available');
                }
                
                if (typeof Canvas2D === 'undefined') {
                    log('‚ùå Canvas2D not available!', 'error');
                } else {
                    log('‚úÖ Canvas2D available');
                }
                
                if (typeof Game === 'undefined') {
                    log('‚ùå Game object not available!', 'error');
                } else {
                    log('‚úÖ Game object available');
                }
                
                // Test Canvas2D initialization
                try {
                    Canvas2D.initialize('gameArea', 'screen');
                    log('‚úÖ Canvas2D initialized successfully');
                } catch (error) {
                    log(`‚ùå Canvas2D initialization failed: ${error.message}`, 'error');
                }
            });
        }
        
        function testGame() {
            log('=== TESTING GAME START ===');
            
            if (typeof Game === 'undefined') {
                log('‚ùå Game object not available! Run initialization test first.', 'error');
                return;
            }
            
            try {
                // Test Game.start
                Game.start('gameArea', 'screen', 1500, 825);
                log('‚úÖ Game.start() called successfully');
                
                setTimeout(() => {
                    if (Game.gameWorld) {
                        log('‚úÖ Game world exists');
                    } else {
                        log('‚ö†Ô∏è Game world not created yet', 'warning');
                        
                        // Try initializing
                        try {
                            Game.initialize();
                            log('‚úÖ Game.initialize() called');
                            
                            if (Game.gameWorld) {
                                log('‚úÖ Game world created after initialize');
                            } else {
                                log('‚ùå Game world still not created', 'error');
                            }
                        } catch (error) {
                            log(`‚ùå Game.initialize() failed: ${error.message}`, 'error');
                        }
                    }
                }, 500);
                
            } catch (error) {
                log(`‚ùå Game.start() failed: ${error.message}`, 'error');
            }
        }
        
        // Auto-run canvas test on load
        window.onload = function() {
            log('üöÄ Debug test page loaded');
            testCanvas();
        };
    </script>
</body>
</html>